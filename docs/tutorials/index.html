<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Tutorials - Okapi Docs</title>
    <meta name="generator" content="Hugo 0.30.2" />

    
    <meta name="description" content="A PROS library for fast C&#43;&#43; development.">
    
    <link rel="canonical" href="https://okapilib.github.io/OkapiLib/tutorials/">
    
    <meta name="author" content="OkapiLib">
    

    <meta property="og:url" content="https://okapilib.github.io/OkapiLib/tutorials/">
    <meta property="og:title" content="Okapi Docs">
    <meta property="og:image" content="https://okapilib.github.io/OkapiLib/images/okapi.jpg">
    <meta name="apple-mobile-web-app-title" content="Okapi Docs">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://okapilib.github.io/OkapiLib/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://okapilib.github.io/OkapiLib/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://okapilib.github.io/OkapiLib/fonts/icon.eot');
        src: url('https://okapilib.github.io/OkapiLib/fonts/icon.eot')
               format('embedded-opentype'),
             url('https://okapilib.github.io/OkapiLib/fonts/icon.woff')
               format('woff'),
             url('https://okapilib.github.io/OkapiLib/fonts/icon.ttf')
               format('truetype'),
             url('https://okapilib.github.io/OkapiLib/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://okapilib.github.io/OkapiLib/stylesheets/application.css">
    <link rel="stylesheet" href="https://okapilib.github.io/OkapiLib/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://okapilib.github.io/OkapiLib/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://okapilib.github.io/OkapiLib/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <link rel="stylesheet" href="https://okapilib.github.io/OkapiLib/css/imageAlign.css">
    
    <script src="https://okapilib.github.io/OkapiLib/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-red palette-accent-teal">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Tutorials
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/OkapiLib" title="@OkapiLib on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://github.com/OkapiLib/OkapiLib" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="https://okapilib.github.io/OkapiLib/images/okapi.jpg">
        </div>
      
      <div class="name">
        <strong>Okapi Docs <span class="version">0.2.4</span></strong>
        
          <br>
          OkapiLib/OkapiLib
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            <a href="https://github.com/OkapiLib/OkapiLib/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/OkapiLib/OkapiLib/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Home" href="https://okapilib.github.io/OkapiLib/home/">
	
	Home
</a>



  
</li>



<li>
  
    



<a  title="Getting started" href="https://okapilib.github.io/OkapiLib/getting-started/">
	
	Getting started
</a>



  
</li>



<li>
  
    



<a class="current" title="Tutorials" href="https://okapilib.github.io/OkapiLib/tutorials/">
	
	Tutorials
</a>


<ul id="scrollspy">
</ul>


  
</li>



<li>
  
    



<a  title="API" href="https://okapilib.github.io/OkapiLib/api/">
	
	API
</a>



  
</li>



<li>
  
    



<a  title="License" href="https://okapilib.github.io/OkapiLib/license/">
	
	License
</a>



  
</li>


        </ul>
        

        
        <hr>
        <span class="section">The author</span>
        
        <ul>
          

          
          <li>
            <a href="https://github.com/OkapiLib" target="_blank" title="@OkapiLib on GitHub">
              @OkapiLib on GitHub
            </a>
          </li>
          

          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Tutorials </h1>

			

<h2 id="tutorials">Tutorials</h2>

<p>This section contains various tutorials for the different parts of OkapiLib. Scroll down or view the menus on the left to pick a tutorial.</p>

<p><h2 id="motor">Motor</h2>

<p>Writing the full <code>Motor</code> constructor any time you want to specify a motor gets quite tedious, so Okapi has some literals that make specifying motors much easier:</p>

<pre><code class="language-c++">Motor foo(2); //Motor on port 2
Motor foo = 2_m; //Equivalent literal

Motor foo(2, true); //Reversed motor on port 2
Motor foo = 2_rm; //Equivalent literal
</code></pre>

<p>Okapi also provides cubic control if you prefer to drive that way:</p>

<pre><code class="language-c++">CubicMotor foo(2); //Motor on port 2
CubicMotor foo = 2_3m; //Equivalent literal

CubicMotor foo(2, true); //Reversed motor on port 2
CubicMotor foo = 2_3rm; //Equivalent literal
</code></pre>

<p>Both <code>Motor</code> and <code>CubicMotor</code> can be given to a <code>ChassisModel</code>, and the behavior of <code>tank</code> and <code>arcade</code> will change accordingly.</p>

<h2 id="pid">PID</h2>

<p>Proportional-Integral-Derivative (PID) control is a simple and useful closed-loop controller. Say you have a subsystem with a motor and a potentiometer:</p>

<pre><code class="language-c++">#include &lt;device/pid.h&gt;

int port = 1; //Motor port
int pot = 1; //Potentiometer
Pid controller(1, 0.2, 0.3); //PID controller with kP = 1, kI = 0.2, kD = 0.3
controller.setTarget(1500); //Set the target to 1500 on the potentiometer

while (1) {
    controller.loop(analogRead(pot)); //Loop the controller with the new pot reading
    motorSet(port, controller.getOutput()); //Power the motor with the output of the controller
    taskDelay(15);
}
</code></pre>

<h2 id="generic-controller">Generic Controller</h2>

<p>Often times, you have a closed-loop controller, sensor, and a few motors acting together as a system, and you wind up with code that powers each motor individually like this:</p>

<pre><code class="language-c++">#include &lt;device/pid.h&gt;

int port1 = 1, port2 = 2; //Motor ports
int pot = 1; //Potentiometer
Pid controller(1, 0.2, 0.3); //PID controller with kP = 1, kI = 0.2, kD = 0.3
controller.setTarget(1500); //Set the target to 1500 on the potentiometer

while (1) {
    controller.loop(analogRead(pot)); //Loop the controller with the new pot reading
    //Power the motors with the output of the controller
    motorSet(port1, controller.getOutput());
    motorSet(port2, controller.getOutput());
    taskDelay(15);
</code></pre>

<p>The more motors and control structure we have, the messier this becomes. So instead, Okapi provides a way to do this in a cleaner fashion:</p>

<pre><code class="language-c++">#include &lt;device/pid.h&gt;
#include &lt;control/genericController.h&gt;

int pot = 1;
//Two motors in ports 1 and 2 like before
//Use make_shared to give GenericController the instance of your ControlObject
GenericController&lt;2&gt; liftController({1_m, 2_m}, std::make_shared&lt;Pid&gt;(Pid(1, 0.2, 0.3)));
liftController.setTarget(1500);

while (1) {
    controller.loop(analogRead(pot)); //Loop the controller and power the motors
    taskDelay(15);
}
</code></pre>

<h2 id="chassis-model">Chassis Model</h2>

<p>Okapi has a way to represent the most common robot chassis, skid steer and x-drive. With this model we can tell the robot how to move around in a general sense.</p>

<p>For example, a skid steer chassis with two motors per side and two quad encoders:</p>

<pre><code class="language-c++">#include &lt;chassis/chassisModel.h&gt;

SkidSteerModel&lt;2&gt; model({2_m, 3_m, 4_m, 5_m}, //Left motors: 2 &amp; 3, right motors: 4 &amp; 5
                        QuadEncoder(1, 2, true), //Left encoder (reversed)
                        QuadEncoder(3, 4)); //Right encoder
</code></pre>

<p>Or you can have an x-drive with one motor per corner and two quad encoders:</p>

<pre><code class="language-c++">#include &lt;chassis/chassisModel.h&gt;

XDriveModel&lt;1&gt; model({2_m, 3_m, 4_m, 5_m}, //Motors are ordered counter-clockwise from the top left
                        QuadEncoder(1, 2, true), //Top left encoder (reversed)
                        QuadEncoder(3, 4)); //Top right encoder
</code></pre>

<p>Then once we have a model, we can do everything a generic <code>ChassisModel</code> can do:</p>

<pre><code class="language-c++">model.driveForward(100); //Drive forward at 100 power
model.turnClockwise(90); //Turn clockwise at 90 power
model.tank(joystickGetAnalog(1, 4), joystickGetAnalog(1, 3)); //Tank drive on the vertical channels
model.stop(); //Set all motors to 0
</code></pre>

<p>If we wanted to use some sort of closed-loop control, we could either do it ourselves or use one of Okapi&rsquo;s structures instead, covered in the <code>ChassisController</code> or <code>OdomChassisController</code> tutorials.</p>

<h2 id="chassis-controller">Chassis Controller</h2>

<p>Okapi provides a way to control a <code>ChassisModel</code> using closed-loop control, like PID, so you don&rsquo;t have to rewrite a driveStraight() function every year. Rather than making a model directly, we can instead give <code>ChassisModelParams</code> to a <code>ChassisController</code>, which will instantiate the model for itself:</p>

<pre><code class="language-c++">#include &lt;chassis/chassisController.h&gt;
ChassisControllerPid controller(SkidSteerModelParams&lt;2&gt;({2_m, 3_m, 4_m, 5_m}, //Skid steer chassis with two motors per side
                                                        QuadEncoder(1, 2, true), //Left encoder (reversed)
                                                        QuadEncoder(3, 4)), //Right encoder
                                PidParams(0.15, 0.05, 0.07), //Distance PID controller
                                PidParams(0.02, 0.01, 0)); //Angle PID controller
</code></pre>

<p>A <code>ChassisControllerPid</code> implements the <code>ChassisController</code> interface using PID control. It takes two <code>PidParams</code> to describe the controller gains for both controllers. The first controls distance to the target, but the second keeps the robot on a straight path while it drives to its target. Often times the second controller&rsquo;s gains will have lower kP, lower or no kD, and moderate kI because this controller just needs to make slight adjustments to the power the motors on each side of the chassis get.</p>

<p>Once we have our controller, we can control the robot more accurately than with just a model:</p>

<pre><code class="language-c++">controller.driveStraight(100); //Drive in a straight line for 100 encoder ticks
controller.pointTurn(100); //Turn clockwise in place for 100 encoder ticks
</code></pre>
</p>


			<aside class="copyright" role="note">
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="https://okapilib.github.io/OkapiLib/" title="Okapi Documentation">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Okapi Documentation
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'https:\/\/okapilib.github.io\/OkapiLib\/';
      var repo_id  = 'OkapiLib\/OkapiLib';
    
    </script>

    <script src="https://okapilib.github.io/OkapiLib/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
         
        ga('create', 'UA-108357936-1', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
         
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
         
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

